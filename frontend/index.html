<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>RD New Projects</title>
    <!----------------https://tabulator.info/----------------------------->
    <link
      href="https://unpkg.com/tabulator-tables@5.4.3/dist/css/tabulator.min.css"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
      rel="stylesheet"
    />
    <!----------------------------------------------------------------->

    <!----------------CSS Files----------------------------->
    <?!=includeExternalFile("frontend/CSS/main-CSS") ?>
    <?!=includeExternalFile("frontend/CSS/loader-wraper-CSS") ?>
  </head>

  <body>
    <div class="loader-wrapper" id="loader-wrapper">
      <div id="loader"></div>
      <div class="loaderText">Please wait</div>
    </div>
    <!-- <div class="form">-->
    <!------------------------------>
    <form class="form" id="userForm">
      <img
        src="https://upload.wikimedia.org/wikipedia/commons/2/2b/Valeo_Logo.svg"
        alt="Valeo logo"
      />
      <div class="addNewProject-container">
        <div class="newProjectInformation">
          <div class="projectImputs-container">
            <div class="form_input-container">
              <label for="strCode">STR Code</label>
              <input id="strCode" type="text" required />
            </div>
            <div class="form_input-container">
              <label for="projectName">Project Name</label>
              <input id="projectName" type="text" required />
            </div>
            <div class="form_input-container">
              <label for="customer">Customer</label>
              <select name="customer" id="customer" required>
                <option></option>
                <option value="volvo">Volvo</option>
                <option value="saab">Saab</option>
                <option value="mercedes">Mercedes</option>
                <option value="audi">Audi</option>
              </select>
            </div>
          </div>
          <div class="buttons-addProject">
            <div class="searchButton-container">
              <button id="searchButton" class="searchButton">
                <span class="material-symbols-outlined"> search </span>
              </button>
            </div>

            <div class="addProjectButton-container">
              <button id="addProjectButton" class="addProjectButton">
                <span class="material-symbols-outlined"> docs_add_on </span>
              </button>
            </div>
          </div>
        </div>
        <div class="alertsWindow" id="alertsWindow"></div>
        <div class="foldersAccesInformation">
          <div class="serverAcces-text">Server acces</div>

          <div class="servers-box" id="servers-box">
            <!------------ Template for server leds --------------------->
            <template id="ledBox-template">
              <div class="led-box">
                <div class="serverName-Box">
                  <p class="server-title">Server Name</p>
                </div>

                <div class="serverFiles">
                  <div class="led"></div>
                  <p class="server-description" id="serverWithFilesDescription">
                    Projects Folder
                  </p>
                </div>
                <div class="templateFiles">
                  <div class="led"></div>
                  <p
                    class="server-description"
                    id="serverWithTemplatesDescription"
                  >
                    Template Folder
                  </p>
                </div>
              </div>
            </template>
            <!------------------------------------------------>
          </div>
        </div>
      </div>
      <div id="projectList-container" class="projectList-container">
        <!-- ---------------------------------------------- -->
        <template>
          <div class="projectList">
            <div id="data-table" class="data-table"></div>
          </div>
        </template>
        <!-- ---------------------------------------------- -->
      </div>
      <!--</div>-->
    </form>
    <!--------------------- Projects List ----------------------------->
    <script
      type="text/javascript"
      src="https://unpkg.com/tabulator-tables@5.4.3/dist/js/tabulator.min.js"
    ></script>
    <!-- add separate file with Table scripts -->
    <?!=includeExternalFile("frontend/scripts/ProjectList") ?>
    <!----------------------------------------------------------------->

    <!-- add separate file with Led scripts -->
    <?!=includeExternalFile("frontend/scripts/servers_led_scripts") ?>
    <!----------------------------------------------------------------->

    <!-- add separate file subbmit scripts -->
    <?!=includeExternalFile("frontend/scripts/subbmitScripts") ?>
    <!----------------------------------------------------------------->

    <!-- add separate file search scripts -->
    <?!=includeExternalFile("frontend/scripts/searchButtonScripts") ?>
    <!----------------------------------------------------------------->

    <script>
      let allFoldersAccessRights = false;
      let serverAccesInformation = [];
      const websiteElements = {};

      document.addEventListener("DOMContentLoaded", pageLoad);
      websiteElements.alertsWindow = document.getElementById("alertsWindow");

      function pageLoad() {
        //loadData(); //projects table underconstruction
        getServerAccesInformationForTheUser();
      }

      function clearAlerts(element) {
        setTimeout(() => {
          element.textContent = "";
        }, 2500);
      }

      /* ------------------------------------------------------------------------------------------ */
      function runGoogleScriptWithPromises(serverFunctionName, variables = "") {
        return new Promise((resolve, reject) => {
          google.script.run
            .withSuccessHandler((data) => {
              resolve(data);
            })
            .withFailureHandler((er) => {
              reject(er);
            })
            [serverFunctionName](variables);
        });
      }

      /**
       * EVENT LISTENERS
       */
      document
        .getElementById("addProjectButton")
        .addEventListener("click", afterButtonAddSubmit);

      document
        .getElementById("searchButton")
        .addEventListener("click", afterButtonSearchSubmit);

      /* ------------------------------------------------------------------------------------------ */
    </script>
  </body>
</html>
